@model YatirimKoc.Application.Features.Listings.Commands.CreateListingCommand
@{
    ViewData["Title"] = "Yeni İlan";
    Layout = "~/Areas/Admin/Views/Shared/AdminLayout.cshtml";
}

<div class="card big">
    <h2 style="margin-bottom:20px;">Yeni İlan Ekle</h2>

    <form method="post" enctype="multipart/form-data">

        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;">

            <div>
                <label>Başlık</label>
                <input asp-for="Title" class="input-dark" />
            </div>

            <div>
                <label>Fiyat</label>
                <input asp-for="Price" type="number" step="0.01" class="input-dark" />
            </div>

            <div>
                <label>Şehir</label>
                <input asp-for="City" class="input-dark" />
            </div>

            <div>
                <label>İlçe</label>
                <input asp-for="District" class="input-dark" />
            </div>

            <div style="grid-column:span 2;">
                <label>Açıklama</label>
                <textarea asp-for="Description" rows="4" class="input-dark"></textarea>
            </div>

            <div>
                <label>Yayında mı?</label>
                <input asp-for="IsPublished" type="checkbox" />
            </div>

            <div style="grid-column:span 2;">
                <label>Fotoğraflar</label>

                <div class="upload-box" id="dropArea">
                    <p>Dosyaları sürükle bırak veya tıkla</p>
                    <input type="file" id="fileInput" multiple hidden />
                </div>

                <div id="previewArea" style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;"></div>
            </div>

        </div>

        <div style="margin-top:20px;">
            <button type="submit" class="btn">
                <i class="fa fa-save"></i> Kaydet
            </button>
        </div>

    </form>
</div>
@section Scripts {
    <script>
        const dropArea = document.getElementById("dropArea");
        const fileInput = document.getElementById("fileInput");
        const previewArea = document.getElementById("previewArea");

        dropArea.addEventListener("click", () => fileInput.click());

        fileInput.addEventListener("change", function () {
            handleFiles(this.files);
        });

        dropArea.addEventListener("dragover", e => {
            e.preventDefault();
            dropArea.style.borderColor = "#7c3aed";
        });

        dropArea.addEventListener("dragleave", e => {
            e.preventDefault();
            dropArea.style.borderColor = "rgba(255,255,255,0.2)";
        });

        dropArea.addEventListener("drop", e => {
            e.preventDefault();
            fileInput.files = e.dataTransfer.files;
            handleFiles(e.dataTransfer.files);
        });

        function handleFiles(files) {
            previewArea.innerHTML = "";
            [...files].forEach(file => {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const img = document.createElement("img");
                    img.src = e.target.result;
                    img.className = "preview-img";
                    previewArea.appendChild(img);
                }
                reader.readAsDataURL(file);
            });
        }
    </script>
}
