@model List<YatirimKoc.Domain.Entities.Listings.Listing>
@{
    ViewData["Title"] = "İlan Yönetimi";
    Layout = "~/Areas/Admin/Views/Shared/AdminLayout.cshtml";
}

<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 30px;">
    <div>
        <h2 style="margin:0; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight:700;">
            <i class="fa-solid fa-building" style="color: var(--accent-1); margin-right:10px;"></i> İlan Yönetimi
        </h2>
        <p style="color: var(--muted); margin-top:5px; font-size:14px;">Sistemdeki tüm emlak ilanlarını buradan yönetebilirsiniz.</p>
    </div>
    <a asp-action="CreateWizard" class="btn-primary" style="text-decoration:none;">
        <i class="fa-solid fa-plus" style="margin-right:8px;"></i> Yeni İlan Ekle
    </a>
</div>

<div class="glass-panel" style="border-radius: var(--radius-lg); padding: 25px; overflow-x: auto;">

    @if (!Model.Any())
    {
        <div style="text-align:center; padding: 60px 20px; color: var(--muted);">
            <div style="width:80px; height:80px; border-radius:50%; background:var(--glass-bg); display:flex; align-items:center; justify-content:center; margin:0 auto 20px auto; border:1px solid var(--glass-border);">
                <i class="fa-solid fa-box-open" style="font-size: 32px; color: var(--accent-2);"></i>
            </div>
            <h4 style="color:#fff; margin-bottom:10px;">Henüz İlan Eklenmemiş</h4>
            <p>Sistemde listelenecek bir ilan bulunamadı. Hemen ilk ilanınızı oluşturun.</p>
            <a asp-action="CreateWizard" class="btn-secondary" style="margin-top:15px; text-decoration:none;">Oluşturmaya Başla</a>
        </div>
    }
    else
    {
        <table style="width: 100%; text-align: left; border-collapse: collapse; min-width:900px;">
            <thead>
                <tr style="border-bottom: 2px solid var(--glass-border); color: var(--muted); font-size:13px; text-transform:uppercase; letter-spacing:1px;">
                    <th style="padding: 15px 10px;">Kapak</th>
                    <th style="padding: 15px 10px;">İlan Bilgileri</th>
                    <th style="padding: 15px 10px;">Kategori / Tür</th>
                    <th style="padding: 15px 10px;">Fiyat</th>
                    <th style="padding: 15px 10px;">Konum</th>
                    <th style="padding: 15px 10px;">Durum</th>
                    <th style="padding: 15px 10px; text-align:right;">İşlemler</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var listing in Model)
                {
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05); transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='rgba(255,255,255,0.02)'" onmouseout="this.style.backgroundColor='transparent'">

                        <td style="padding: 15px 10px;">
                            <div style="width: 65px; height: 65px; border-radius: 12px; overflow: hidden; background: var(--glass-bg); border: 1px solid var(--glass-border); box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
                                @if (listing.Images != null && listing.Images.Any(x => x.IsCover))
                                {
                                    <img src="@listing.Images.First(x => x.IsCover).ImageUrl" style="width:100%; height:100%; object-fit:cover;" alt="Kapak" />
                                }
                                else if (listing.Images != null && listing.Images.Any())
                                {
                                    <img src="@listing.Images.First().ImageUrl" style="width:100%; height:100%; object-fit:cover;" alt="Görsel" />
                                }
                                else
                                {
                                    <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; color: var(--muted); background: rgba(0,0,0,0.4);">
                                        <i class="fa-solid fa-image"></i>
                                    </div>
                                }
                            </div>
                        </td>

                        <td style="padding: 15px 10px;">
                            <div style="font-weight: 600; color: #fff; font-size:15px; margin-bottom:4px;">
                                @(listing.Title.Length > 40 ? listing.Title.Substring(0, 40) + "..." : listing.Title)
                            </div>
                            <div style="font-size: 12px; color: var(--muted); display:flex; align-items:center; gap:5px;">
                                <i class="fa-regular fa-hashtag"></i> @listing.Id.ToString().Substring(0, 8).ToUpper()
                            </div>
                        </td>

                        <td style="padding: 15px 10px;">
                            <div style="display:flex; gap:8px;">
                                <span style="background: rgba(139, 92, 246, 0.15); border: 1px solid rgba(139, 92, 246, 0.3); color: #c4b5fd; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">
                                    @listing.TransactionType?.Name
                                </span>
                                <span style="background: rgba(6, 182, 212, 0.15); border: 1px solid rgba(6, 182, 212, 0.3); color: #67e8f9; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">
                                    @listing.PropertyType?.Name
                                </span>
                            </div>
                        </td>

                        <td style="padding: 15px 10px; font-weight: 700; color: var(--accent-2); font-size: 15px;">
                            @listing.Price.ToString("N0") @listing.Currency
                        </td>

                        <td style="padding: 15px 10px; font-size: 14px; color: #cbd5e1;">
                            <i class="fa-solid fa-location-dot" style="color:var(--muted); font-size:12px; margin-right:4px;"></i>
                            @listing.City, @listing.District
                        </td>

                        <td style="padding: 15px 10px;">
                            @if (listing.IsPublished)
                            {
                                <span style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); color: #34d399; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; display:inline-flex; align-items:center; gap:6px;">
                                    <span style="width:6px; height:6px; background:#34d399; border-radius:50%; box-shadow:0 0 5px #34d399;"></span> Yayında
                                </span>
                            }
                            else
                            {
                                <span style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); color: #fcd34d; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; display:inline-flex; align-items:center; gap:6px;">
                                    <span style="width:6px; height:6px; background:#fcd34d; border-radius:50%; box-shadow:0 0 5px #fcd34d;"></span> Taslak
                                </span>
                            }
                        </td>

                        <td style="padding: 15px 10px; text-align:right;">
                            <div style="display: flex; justify-content:flex-end; gap: 8px;">
                                <a href="#" class="icon-btn" title="Görüntüle" style="width:36px; height:36px; font-size:14px;"><i class="fa-solid fa-eye"></i></a>
                                <a href="#" class="icon-btn" title="Düzenle" style="width:36px; height:36px; font-size:14px;"><i class="fa-solid fa-pen-to-square"></i></a>
                                <a href="#" class="icon-btn" title="Sil" style="width:36px; height:36px; font-size:14px; border-color: rgba(239, 68, 68, 0.2); color: #ef4444; background: rgba(239, 68, 68, 0.05);"><i class="fa-solid fa-trash"></i></a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
</div>